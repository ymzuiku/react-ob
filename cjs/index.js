var c=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames,T=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var b=(n,e,t)=>e in n?c(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,a=(n,e)=>{for(var t in e||(e={}))v.call(e,t)&&b(n,t,e[t]);if(T)for(var t of T(e))x.call(e,t)&&b(n,t,e[t]);return n};var k=n=>c(n,"__esModule",{value:!0});var S=(n,e)=>{for(var t in e)c(n,t,{get:e[t],enumerable:!0})},w=(n,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of m(e))!v.call(n,r)&&(t||r!=="default")&&c(n,r,{get:()=>e[r],enumerable:!(s=d(e,r))||s.enumerable});return n};var O=(n=>(e,t)=>n&&n.get(e)||(t=w(k({}),e,1),n&&n.set(e,t),t))(typeof WeakMap!="undefined"?new WeakMap:0);var C={};S(C,{Consumer:()=>h,Observer:()=>E,useObserver:()=>p});var o=require("react");function p(n,e){let[t,s]=(0,o.useState)(n.val),r=(0,o.useRef)(e(n.val));return(0,o.useEffect)(()=>{let f=()=>{let l=!1,i=e(n.val);for(let u=0;u<i.length;u++)if(i[u]!==r.current[u]){l=!0;break}r.current=i,l&&s(a({},n.val))};return n.subscribs.add(f),()=>{n.subscribs.delete(f)}},[]),t}function h({data:n,render:e,memo:t}){let s=p(n,t);return e(s)}function E(n){let e=new Set,t={subscribs:e,next:s=>{s?Promise.resolve(s(t.val)).then(()=>{e.forEach(r=>r())}):e.forEach(r=>r())},val:n};return t}module.exports=O(C);
