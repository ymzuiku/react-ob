import{useRef as p}from"react";var i=null;function o(){i&&(clearTimeout(i),i=null),i=setTimeout(()=>{o.update()},16)}o.update=()=>{};o.forceUpdate=()=>{};function f(e){let r=e,t=()=>r;return t.set=n=>{r=n,o()},t}function b(e){return p(f(e)).current}function O(e){return typeof e=="function"&&typeof e.set=="function"}function d(e){if(typeof window=="undefined")return;let r=localStorage.getItem(e);if(!!r)try{return JSON.parse(r).j}catch(t){return}}function h(e,r){typeof window!="undefined"&&localStorage.setItem(e,JSON.stringify({j:r}))}function w(e,r){let t=r,n=!1,u=()=>{if(!n){let a=d(e);a!==void 0&&(n=!0,t=a,o())}return t};return u.set=a=>{t=a,o(),h(e,t)},u}import{Component as m,createContext as T,createElement as l,useContext as x,useMemo as C,useState as g}from"react";var s=T(0);function U({children:e,channels:r}){x(s);let t=r.map(n=>n());return C(()=>e(...t),t)}function j({children:e}){let[r,t]=g(0);return o.update=()=>{t(n=>(n+=1,n>9999&&(n=0),n))},l(s.Provider,{children:e,value:r})}var c=class extends m{constructor(t){super(t);this.state={value:0};o.update=()=>{let n=this.state.value+1;n>9999&&(n=0),this.setState(n)},o.forceUpdate=()=>{this.forceUpdate()}}render(){return l(s.Provider,{children:this.props.children,value:this.state.value})}};export{U as Ob,j as ObProvider,c as ObProvider2,f as channel,w as channelWithStorage,O as isChannel,o as publish,b as useChannel};
