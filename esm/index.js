var v=Object.defineProperty;var f=Object.getOwnPropertySymbols;var b=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;var l=(n,e,t)=>e in n?v(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,T=(n,e)=>{for(var t in e||(e={}))b.call(e,t)&&l(n,t,e[t]);if(f)for(var t of f(e))a.call(e,t)&&l(n,t,e[t]);return n};import{useEffect as p,useRef as d,useState as m}from"react";function x(n,e){let[t,r]=m(n.val),s=d(e(n.val));return p(()=>{let c=()=>{let i=!1,u=e(n.val);for(let o=0;o<u.length;o++)if(u[o]!==s.current[o]){i=!0;break}s.current=u,i&&r(T({},n.val))};return n.subscribs.add(c),()=>{n.subscribs.delete(c)}},[]),t}function w({data:n,render:e,memo:t}){let r=x(n,t);return e(r)}function O(n){let e=new Set,t={subscribs:e,next:r=>{r?Promise.resolve(r(t.val)).then(()=>{e.forEach(s=>s())}):e.forEach(s=>s())},val:n};return t}export{w as Consumer,O as Observer,x as useObserver};
