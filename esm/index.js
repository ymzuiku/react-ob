var h=Object.defineProperty;var i=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var l=(e,r,n)=>r in e?h(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n,c=(e,r)=>{for(var n in r||(r={}))v.call(r,n)&&l(e,n,r[n]);if(i)for(var n of i(r))T.call(r,n)&&l(e,n,r[n]);return e};import*as a from"react";import{useEffect as x,useMemo as d,useRef as S,useState as C}from"react";var O=typeof Element!="undefined",m=typeof Map=="function",g=typeof Set=="function",w=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function f(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;let n,t,o;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(t=n;t--!==0;)if(!f(e[t],r[t]))return!1;return!0}let s;if(m&&e instanceof Map&&r instanceof Map){if(e.size!==r.size)return!1;for(s=e.entries();!(t=s.next()).done;)if(!r.has(t.value[0]))return!1;for(s=e.entries();!(t=s.next()).done;)if(!f(t.value[1],r.get(t.value[0])))return!1;return!0}if(g&&e instanceof Set&&r instanceof Set){if(e.size!==r.size)return!1;for(s=e.entries();!(t=s.next()).done;)if(!r.has(t.value[0]))return!1;return!0}if(w&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(r)){if(n=e.length,n!=r.length)return!1;for(t=n;t--!==0;)if(e[t]!==r[t])return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(o=Object.keys(e),n=o.length,n!==Object.keys(r).length)return!1;for(t=n;t--!==0;)if(!Object.prototype.hasOwnProperty.call(r,o[t]))return!1;if(O&&e instanceof Element)return!1;for(t=n;t--!==0;)if(!((o[t]==="_owner"||o[t]==="__v"||o[t]==="__o")&&e.$$typeof)&&!f(e[o[t]],r[o[t]]))return!1;return!0}return e!==e&&r!==r}function p(e,r){try{return f(e,r)}catch(n){if((n.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw n}}function k(e,r){let[n,t]=C(e.val),o=S(r(e.val));return x(()=>{let s=()=>{let u=r(e.val),y=!p(u,o.current);o.current=u,y&&t(c({},e.val))};return e.subscribs.add(s),()=>{e.subscribs.delete(s)}},[]),n}function z({data:e,children:r,memo:n}){let t=k(e,n);return r(t)}function E(e){let r=new Set,n={subscribs:r,next:t=>{t?Promise.resolve(t(n.val)).then(()=>{r.forEach(o=>o())}):r.forEach(o=>o())},val:e};return n}function P(e,r){return d(()=>E(e),r)}export{z as Consumer,E as CreateObserver,p as isEqual,P as useCreateObserver,k as useObserver};
