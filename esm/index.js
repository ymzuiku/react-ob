var h=Object.defineProperty;var c=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var a=(e,t,n)=>t in e?h(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,y=(e,t)=>{for(var n in t||(t={}))v.call(t,n)&&a(e,n,t[n]);if(c)for(var n of c(t))T.call(t,n)&&a(e,n,t[n]);return e};import{useEffect as m,useMemo as d,useRef as S,useState as k}from"react";var O=typeof Element!="undefined",w=typeof Map=="function",g=typeof Set=="function",x=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function u(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;let n,r,o;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(!u(e[r],t[r]))return!1;return!0}let s;if(w&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(s=e.entries();!(r=s.next()).done;)if(!t.has(r.value[0]))return!1;for(s=e.entries();!(r=s.next()).done;)if(!u(r.value[1],t.get(r.value[0])))return!1;return!0}if(g&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(s=e.entries();!(r=s.next()).done;)if(!t.has(r.value[0]))return!1;return!0}if(x&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(o=Object.keys(e),n=o.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,o[r]))return!1;if(O&&e instanceof Element)return!1;for(r=n;r--!==0;)if(!((o[r]==="_owner"||o[r]==="__v"||o[r]==="__o")&&e.$$typeof)&&!u(e[o[r]],t[o[r]]))return!1;return!0}return e!==e&&t!==t}function p(e,t){try{return u(e,t)}catch(n){if((n.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw n}}function C(e,t){let[n,r]=k(e.val),o=S(t(e.val));return m(()=>{let s=()=>{let l=!1,i=t(e.val);for(let f=0;f<i.length;f++)if(p(i[f],o.current[f])){l=!0;break}o.current=i,l&&r(y({},e.val))};return e.subscribs.add(s),()=>{e.subscribs.delete(s)}},[]),n}function _({data:e,children:t,memo:n}){let r=C(e,n);return t(r)}function E(e){let t=new Set,n={subscribs:t,next:r=>{r?Promise.resolve(r(n.val)).then(()=>{t.forEach(o=>o())}):t.forEach(o=>o())},val:e};return n}function z(e,t){return d(()=>E(e),t)}export{_ as Consumer,E as NewObserver,p as isEqual,z as useNewObserver,C as useObserver};
