var v=Object.defineProperty;var c=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var a=(e,t,n)=>t in e?v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,p=(e,t)=>{for(var n in t||(t={}))T.call(t,n)&&a(e,n,t[n]);if(c)for(var n of c(t))O.call(t,n)&&a(e,n,t[n]);return e};import*as y from"react";import{useEffect as d,useMemo as S,useRef as k,useState as C}from"react";var g=typeof Element!="undefined",m=typeof Map=="function",x=typeof Set=="function",w=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function u(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;let n,r,o;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(!u(e[r],t[r]))return!1;return!0}let s;if(m&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(s=e.entries();!(r=s.next()).done;)if(!t.has(r.value[0]))return!1;for(s=e.entries();!(r=s.next()).done;)if(!u(r.value[1],t.get(r.value[0])))return!1;return!0}if(x&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(s=e.entries();!(r=s.next()).done;)if(!t.has(r.value[0]))return!1;return!0}if(w&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(o=Object.keys(e),n=o.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,o[r]))return!1;if(g&&e instanceof Element)return!1;for(r=n;r--!==0;)if(!((o[r]==="_owner"||o[r]==="__v"||o[r]==="__o")&&e.$$typeof)&&!u(e[o[r]],t[o[r]]))return!1;return!0}return e!==e&&t!==t}function h(e,t){try{return u(e,t)}catch(n){if((n.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw n}}function E(e,t){let[n,r]=C(e.val),o=k(t(e.val));return d(()=>{let s=()=>{let l=!1,i=t(e.val);for(let f=0;f<i.length;f++)if(h(i[f],o.current[f])){l=!0;break}o.current=i,l&&r(p({},e.val))};return e.subscribs.add(s),()=>{e.subscribs.delete(s)}},[]),n}function P({data:e,children:t,memo:n}){let r=E(e,n);return t(r)}function A(e){let t=new Set,n={subscribs:t,next:r=>{r?Promise.resolve(r(n.val)).then(()=>{t.forEach(o=>o())}):t.forEach(o=>o())},val:e};return n}function q(e,t){return S(()=>A(e),t)}export{P as Consumer,A as CreateObserver,h as isEqual,q as useCreateObserver,E as useObserver};
